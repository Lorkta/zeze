# 第三十章 Task

## 简介
这是一个任务系统的框架。应用的时候需要相当的进一步开发，并不是拿来就可以用。
由于任务系统关联很多地方，所以首要的问题怎么进一步开发。

## 整体试图
任务系统(Task)
奖励系统(Reward)
任务配置(TaskGraphics)
地图系统(World)
包裹系统(Bag)

## 任务系统(Task)
* 玩家操作（接受任务，完成任务，放弃任务）
* 玩家已接任务列表的访问和状态更新
* npc可接、可交任务提示
* 接受任务时查看任务描述

## 奖励系统进一步开发
```
public interface Reward {
	int getRewardId();

	// 下面两个方法的结果通常打包到给客户端的任务结构里面，由客户端完成任务奖励提示的显示。
	// 每种任务奖励的显示方式都可能不一样。
	int getRewardType();
	Binary getRewardParam(long roleId);

	// 发放奖励，一般是任务完成的时候由任务系统调用。广义的，这个方法也可以实现任意时机的奖励发放。
	void reward(long roleId);
}
```
实现自己的各种奖励方式，并注册到RewardConfig中。奖励方式包括但不限于：所有的物品一起奖给玩家；
按权重随机选择部分物品奖励给玩家；根据玩家职业，选择相应的奖品给他；...
```
taskModule.getRewardConfig.put(new MyReward1());
```

## 任务配置(TaskGraphics)
应用需要一个任务配置编辑器，可以使用TaskGraphics作为任务编辑器的后端存储。由于TaskGraphics是
java开发的，可能不好直接接入。这样的话，应用可以自行决定编辑器的存储，在对接本任务系统时，把配置
数据导入到TaskGraphics中。由于需要对接任务配置，应用自己的任务编辑器不是完全自由的，需要匹配
数据结构。具体要求请查看TaskGraphics的代码。

## 地图系统(World)
* 地图系统需要支持订阅玩家进入退出某个多边形区域的事件；
* 地图系统需要得到新的npc进入玩家视野的列表，用来实现这个npc对玩家的可接任务提示；
注意某些npc可能具有全图（全世界）视野。
* 地图系统需要能得到玩家附近的npc列表，不仅仅是新进入的。

## 包裹系统(Bag)
任务条件是包裹中的物品时，要求能访问包裹系统某个物品数量，能在任务完成的时候删除包裹中一定数量的物品。

## 要求的类型及它们引发的其他系统对接要求
* int taskId;
* int NpcId;
* int monsterId;
* int itemId;