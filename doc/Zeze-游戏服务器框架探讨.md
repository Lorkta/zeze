# Zeze-游戏服务器框架探讨
这个文章主要探讨游戏服务器框架，并介绍Zeze。

## 框架
所有的游戏开发经过积累都会产生一个叫框架的东西，完成通用功能，解决一些常见技术问题，可以重用。
可能是游戏类型太多的原因，游戏界并没有像Web平台那样，产生一个像Spring一样，应用广泛，比较
通用的框架，几乎每个工作室都有自己的一套做法。现在有个通用的框架叫Zeze，下面从各方面对它进行探讨。
很多框架或代码库在做宣传的时候都会这么说，”使开发人员专注于业务，高效便利的开发“。这也是Zeze的主要目的。

游戏类型很多，有些类型能对负载和功能进行很好拆分，甚至可以用上微服务框架。这里为了避免探讨过于广泛，
先只考虑MMO。一般来说，MMO需要高性能，逻辑关联复杂度高，需求变动大，要求比较高的开发效率，最好具有
分布式能力突破单机瓶颈（一个游戏逻辑服具有更高的在线量）。

## 缓存
游戏服务器一般都采用数据库完成存储，但是逻辑运算（事务）不能直接交给数据库，数据库性能一般不够，
所以都会采取缓存机制，在逻辑服务器内建立数据缓存，逻辑服务器直接访问本地缓存完成计算。
Zeze实现了一个通用缓存，完全解决了这个问题。开发人员只要按需访问自己的数据即可，完全不需要关心
数据的装载，保存，缓存管理完全自动化。

## 多线程和乐观锁
虽然单线程仔细划分功能的方式也很有用，但会增加开发负担，划分本身不是件容易的事情。现在是多核时代，
采用多线程也是很正常的很合理的，主要是不用再去考虑线程划分，容易整体的，一致的把性能扩展的整个机器。
Zeze采用了多线程方案。一般多线程共享数据有死锁的可能，这个问题Zeze采用乐观锁解决。

总之，Zeze是不会死锁的。

## 同步或异步
采用回调方式的异步，不管底层（语言）提供了多少便利，处理流程和思考方式还是隔离的，在复杂逻辑下，
非常难以管理维护。Zeze采用了多线程，自然也默认使用了同步模式，大多数逻辑处理只要关心输入输出，
和业务逻辑，可以很自然的写出实现。几乎达到所见即所得，即业务流程描述怎样，实现代码也怎样，完全
不需要考虑技术问题。当然Zeze也支持异步，这个用在特殊的地方，必须是受控的。

## All In One
由于关联复杂，需求变动大，不同的模块之间互相调用非常多，变动多。为了抵抗这个，Zeze采用了所有模块
都存在于一个进程内的做法。这样模块依赖变动都只是进程内的函数调用。All In One还体现为逻辑需要的所有
数据都能方便的得到。

能访问所有的数据，就能实现所有的业务。

虽然Zeze有模块概念，数据是属于模块内部的，但很容易公开出来（直接公开表或者间接的访问方法），
基本实现了能访问所有的数据。

## 事务
上面提到了”所见即所得，即业务流程描述怎样，实现代码也怎样“这句话在没有事务的时候实际上很难达到。
因为服务器需要考虑一个问题，修改数据的过程中发生了错误，已被修改的部分怎么办。Zeze采用事务解决
这个问题，数据修改要嘛全部成功，要嘛回滚。因为有了事务，当模块之间的逻辑任意关联起来，数据访问
流程非常复杂，都不再需要考虑数据局部变动的问题。

所见即所得。

## 分布式
即使采用了多线程，单机的性能总是有限的，那能不能采用分布式方案，突破单机限制呢？
答案是Zeze也解决了这个问题。Zeze采用一个可分布的Global锁管理器，维护所有服务器的数据同步。
另外不用当心Zeze的分布式，它几乎对开发没有影响，开发起来跟单机开发一样。在Zeze里，分布式几乎
可以看作是运维性质的。也就是说就按单机方式开发，根据性能需求，分布运维即可。

## 采用Zeze的工作方式
这里的工作方式描述，能体现出上面的那句话，”使开发人员专注于业务，高效便利的开发“。

1. 在 solution.xml 中定义协议和存储表，并生成代码。
2. 在生成的协议函数中访问自己定义的存储表实现逻辑。这里访问存储表就跟访问本进程内的内存一样，完全无感。

上面的描述全部是业务，而且没有任何技术问题需要考虑。所以Zeze的入门很容易，开发效率非常高。

## Zeze文档

[Zeze文档](https://gitee.com/e2wugui/zeze/blob/master/doc/index.md)

[Zeze文档目录](https://gitee.com/e2wugui/zeze/blob/master/doc/)
